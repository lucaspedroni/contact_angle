<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Contact Angle by tcmoore3</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Contact Angle</h1>
          <h2>Routines for calculating contact angles from MD simulations</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/tcmoore3/contact_angle/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/tcmoore3/contact_angle/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/tcmoore3/contact_angle" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h3>
<a id="contact-angle-calculations" class="anchor" href="#contact-angle-calculations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contact Angle Calculations</h3>

<p>This package provides routines for calculating contact angles from MD simulations of surface wetting. A script to calculate the contact angle would look something like:</p>

<pre><code>&gt;&gt;&gt; import contact_angle as co
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; import mdtraj as md
&gt;&gt;&gt; import numpy as np

&gt;&gt;&gt; traj = md.load('wetting.xtc', top='wetting.gro')
&gt;&gt;&gt; ca = co.calc_contact_angle(traj.xyz[50:, 29600:], guess_R=1.5, 
        guess_z0=2.0, guess_rho_n=1.0, n_fit=55, left_tol=0.1, 
        z_range=(9, 13), surface_normal='z', n_bins=100)
&gt;&gt;&gt; co.print_contact_angle_results(ca)

Contact angle fitting results
-----------------------------
contact angle =  52.6266050581  degrees
R_fit =  6.78317095664
z0_fit =  5.52256848571
rho_n_fit =  79.3187821804
height =  2.66573944234
right intercept =  12.3057394423
left intercept =  9.64

&gt;&gt;&gt; fig, ax = plt.subplots()
&gt;&gt;&gt; ax.plot(ca['z'], ca['nz'], 'ko', label='raw')
&gt;&gt;&gt; ax.plot(ca['z'], ca['nz_extrapolated'], 'k-', label='fit')
&gt;&gt;&gt; fig.savefig('fit.pdf')
</code></pre>

<p>where we skip the first 50 frames and the molecules in the droplet have indices greater than 29600.</p>

<p>Note that the algorithm fits a parabola to the calculated number density profile, and that the number of points used in the fit can affect the final answer. Therefore, it is advisable to validate your results by</p>

<ol>
<li>visualizing the system to make sure the final answer is reasonable, and</li>
<li>visualizing the results of the fitting.</li>
</ol>

<p><code>calc_contact_angle()</code> returns a dictionary containing the information necessary to visualize the fits. The results of fitting to 50 and 10 points (i.e., <code>n_fit</code> = 50 and 10, respectively) are shown below. Although seemingly similar, fitting with just 10 points gives a contact angle of 18 degrees, versus the more accurate value of 53 degrees when using 50 points. This can also be seen comparing to a snapshot of the system, shown below. Clearly, the contact angle is closer to 53 degrees than 18 degrees. This illustrates the need to validate.
<img src="./images/fit.jpg" alt="Results from fitting to 10 vs. 50 points.">
<img src="./images/droplet.png" alt=""></p>

<p>Currently, several assumptions are made for the calculations:</p>

<ul>
<li>The vector normal to the surface is parallel to the z-axis</li>
<li>The droplet is above the surface in the z-direction</li>
</ul>

<p>These changes will be implemented as needed - feel free to make changes and submit a pull-request.</p>
        </section>

        <footer>
          Contact Angle is maintained by <a href="https://github.com/tcmoore3">tcmoore3</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
