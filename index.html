<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>ContactAangle by tcmoore3</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">ContactAangle</h1>
      <h2 class="project-tagline">Routines for calculating contact angles from MD simulations</h2>
      <a href="https://github.com/tcmoore3/contact_angle" class="btn">View on GitHub</a>
      <a href="https://github.com/tcmoore3/contact_angle/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/tcmoore3/contact_angle/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h3>
<a id="contact-angle-calculations" class="anchor" href="#contact-angle-calculations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contact Angle Calculations</h3>

<p>This package provides routines for calculating contact angles from MD simulations of surface wetting. An script to calculate the contact angle would look something like:</p>

<pre><code>&gt;&gt;&gt; import contact_angle as co
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; import mdtraj as md
&gt;&gt;&gt; import numpy as np

&gt;&gt;&gt; traj = md.load('wetting.xtc', top='wetting.gro')
&gt;&gt;&gt; ca = co.calc_contact_angle(traj.xyz[50:, 29600:], guess_R=1.5, 
        guess_z0=2.0, guess_rho_n=1.0, n_fit=55, left_tol=0.1, 
        z_range=(9, 13), surface_normal='z', n_bins=100)
&gt;&gt;&gt; co.print_contact_angle_results(ca)

Contact angle fitting results
-----------------------------
contact angle =  52.6266050581  degrees
R_fit =  6.78317095664
z0_fit =  5.52256848571
rho_n_fit =  79.3187821804
height =  2.66573944234
right intercept =  12.3057394423
left intercept =  9.64

&gt;&gt;&gt; fig, ax = plt.subplots()
&gt;&gt;&gt; ax.plot(ca['z'], ca['nz'], 'ko', label='raw')
&gt;&gt;&gt; ax.plot(ca['z'], ca['nz_extrapolated'], 'k-', label='fit')
&gt;&gt;&gt; fig.savefig('fit.pdf')
</code></pre>

<p>where we skip the first 50 frames and the molecules in the droplet have indices greater than 29600.</p>

<p>Note that the algorithm fits a parabola to the calculated number density profile, and that the number of points used in the fit can affect the final answer. Therefore, it is advisable to validate your results by</p>

<ol>
<li>visualizing the system to make sure the final answer is reasonable, and</li>
<li>visualizing the results of the fitting.
<code>calc_contact_angle()</code> returns a dictionary containing the information necessary to visualize the fits. The results of fitting to 50 and 10 points (i.e., <code>n_fit</code> = 50 and 10, respectively) are shown below. Note that the calculations give very different answers, illustrating the need to validate.
<img src="https://github.com/tcmoore3/contact_angle/blob/gh-pages/images/fit.jpg" alt="Results from fitting to 10 vs. 50 points.">
</li>
</ol>

<p>Currently, several assumptions are made for the calculations:</p>

<ul>
<li>The vector normal to the surface is parallel to the z-axis</li>
<li>The droplet is above the surface in the z-direction</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/tcmoore3/contact_angle">ContactAangle</a> is maintained by <a href="https://github.com/tcmoore3">tcmoore3</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
